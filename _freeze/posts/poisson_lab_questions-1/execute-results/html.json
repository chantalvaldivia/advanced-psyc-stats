{
  "hash": "edd1d3a79376a8785663e0af7f3e4c25",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab 5 - Poisson - Questions\"\nauthor:\n    date: last-modified\n    format:\n      html:\n        self-contained: true\n        anchor-sections: true\n        code-tools: true\n        code-fold: true\n        fig-width: 8\n        fig-height: 4\n        code-block-bg: \"#f1f3f5\"\n        code-block-border-left: \"#31BAE9\"\n        mainfont: Source Sans Pro\n        theme: journal\n        toc: true\n        toc-depth: 3\n        toc-location: left\n        captions: true\n        cap-location: margin\n        table-captions: true\n        tbl-cap-location: margin\n        reference-location: margin\n      pdf:\n        pdf-engine: lualatex\n        toc: false\n        number-sections: true\n        number-depth: 2\n        top-level-division: section\n        reference-location: document\n        listings: false\n        header-includes:\n          \\usepackage{marginnote, here, relsize, needspace, setspace}\n          \\def\\it{\\emph}\nexecute:\n  freeze: auto\n  echo: true\n  message: false\n  warning: false\n  fig-align: center\n  fig-width: 12\n  fig-height: 8\n  editor_options: \n  chunk_output_type: inline\n  code-overflow: wrap\n  html:\n    code-fold: true\n    code-tools: true\n---\n\n\n\n\n\n1.  To complete this lab:\n\n-   Load packages\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(MASS)\nlibrary(tidyverse)\nlibrary(emmeans)\nlibrary(ggeffects)\nlibrary(easystats)\nlibrary(performance)\nlibrary(knitr)\n```\n:::\n\n\n\n\n\n-   Download the dataset:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\ndata <- read_delim(\"https://raw.githubusercontent.com/jgeller112/psy504-advanced-stats/main/slides/Poisson/data/2010.csv\")\n```\n:::\n\n\n\n\n\n2.  Conduct the analysis described in the preregistration document\n\n<!-- -->\n\na.  The number of hours per week that a person spends on the Internet (\"WWWHR\") will\\\n    be predicted by their vocabulary (\"WORDSUM\"), age (\"AGE\"), sex (\"SEX\"), religiosity\\\n    (\"RELITEN\"), political orientation (\"POLVIEWS\"), and how often they work from home\\\n    (\"WRKHOME\").\n\n-   Let's use the `naniar` package's function `replace_with_na`to clean the data.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(naniar)\n\ndata_pos <- data %>%\n  dplyr::select(wwwhr, wordsum, age, sex, reliten, polviews, wrkhome) %>%\nreplace_with_na(.,\n             replace = list(wwwhr = c(-1, 998, 999),\n                          wordsum = c(-1, 99),\n                          reliten = c(0, 8, 9), \n             polviews = c(0, 8, 9), \n             wrkhome = c(0,8,9), \n             age=c(0, 98, 99)))\n```\n:::\n\n\n\n\n\nQ: Can you explain what might be going on in the above code?\n\n**A: It seems like we are using dplyr to replace some codes (like 0, 8, 9, -1, 99, etc) with NAs.**\n\nQ: The next step in data cleaning would be to ensure that the data in your code are aligned with the description/ usage context of the variables\n\n-   Recode sex and reliten as necessary\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_pos <- data_pos %>% \n  mutate(sex = recode(sex, `-1` = \"Male\", `1` = \"Female\"))\n\ndata_pos$sex <- as.factor(data_pos$sex)\n\ndata_pos <- data_pos %>% \n    mutate(reliten_recode = factor(reliten, levels = c(1, 2, 3, 4, 5), ordered = TRUE))\n```\n:::\n\n\n\n\n\n## Missingness\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_pos %>%\n  dplyr::select(reliten, reliten_recode)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,044 × 2\n   reliten reliten_recode\n     <dbl> <ord>         \n 1       1 1             \n 2       4 4             \n 3       1 1             \n 4       1 1             \n 5       1 1             \n 6       4 4             \n 7       3 3             \n 8       1 1             \n 9       1 1             \n10       1 1             \n# ℹ 2,034 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(skimr)\nskimr::skim(data_pos)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |         |\n|:------------------------|:--------|\n|Name                     |data_pos |\n|Number of rows           |2044     |\n|Number of columns        |8        |\n|_______________________  |         |\n|Column type frequency:   |         |\n|factor                   |2        |\n|numeric                  |6        |\n|________________________ |         |\n|Group variables          |None     |\n\n\n**Variable type: factor**\n\n|skim_variable  | n_missing| complete_rate|ordered | n_unique|top_counts                     |\n|:--------------|---------:|-------------:|:-------|--------:|:------------------------------|\n|sex            |         0|          1.00|FALSE   |        2|Mal: 1153, Fem: 891            |\n|reliten_recode |        99|          0.95|TRUE    |        4|2: 747, 1: 707, 4: 363, 3: 128 |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|  mean|    sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|-----:|-----:|--:|---:|---:|---:|----:|:-----|\n|wwwhr         |       996|          0.51|  9.79| 13.41|  0|   2|   5|  14|  168|▇▁▁▁▁ |\n|wordsum       |       657|          0.68|  6.03|  2.07|  0|   5|   6|   7|   10|▁▃▇▅▂ |\n|age           |         3|          1.00| 47.97| 17.68| 18|  33|  47|  61|   89|▇▇▇▅▃ |\n|reliten       |        99|          0.95|  2.08|  1.08|  1|   1|   2|   3|    4|▇▇▁▂▃ |\n|polviews      |        71|          0.97|  4.08|  1.46|  1|   3|   4|   5|    7|▃▂▇▃▅ |\n|wrkhome       |       882|          0.57|  2.26|  1.72|  1|   1|   1|   4|    6|▇▁▁▂▁ |\n\n\n:::\n:::\n\n\n\n\n\n## Fit a Poisson model to the data.\n\na.  The number of hours per week that a person spends on the Internet (\"WWWHR\") will\\\n    be predicted by their vocabulary (\"WORDSUM\"), age (\"AGE\"), sex (\"SEX\"), religiosity\\\n    (\"RELITEN\"), political orientation (\"POLVIEWS\"), and how often they work from home\\\n    (\"WRKHOME\").\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- glm(wwwhr ~ wordsum + age + sex + reliten_recode + polviews + wrkhome,                  data = data_pos, \n                 family = poisson(link = \"log\"))\n\nlibrary(broom)\nmodel %>%\n  tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 5\n  term             estimate std.error statistic   p.value\n  <chr>               <dbl>     <dbl>     <dbl>     <dbl>\n1 (Intercept)        2.36     0.0737      32.0  9.60e-225\n2 wordsum            0.102    0.00781     13.1  6.08e- 39\n3 age               -0.0166   0.00109    -15.3  1.04e- 52\n4 sexMale           -0.250    0.0266      -9.42 4.55e- 21\n5 reliten_recode.L   0.457    0.0295      15.5  2.77e- 54\n6 reliten_recode.Q  -0.0465   0.0351      -1.32 1.86e-  1\n7 reliten_recode.C   0.103    0.0413       2.50 1.24e-  2\n8 polviews          -0.0326   0.00977     -3.34 8.31e-  4\n9 wrkhome            0.0787   0.00766     10.3  9.93e- 25\n```\n\n\n:::\n:::\n\n\n\n\n\n## Carry out model checking\n\nHint: performance package has the function you're looking for\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(model,plot = T)\n```\n\n::: {.cell-output-display}\n![](poisson_lab_questions-1_files/figure-html/unnamed-chunk-7-1.png){width=1152}\n:::\n:::\n\n\n\n\n\n## Find any outliers\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Q <- quantile(data_pos$wwwhr, probs=c(.25, .75), na.rm = T)\n#iqr <- IQR(data_pos$wwwhr, na.rm = T)\n\n#up <-  Q[2]+1.5*iqr # Upper Range  \n#low<- Q[1]-1.5*iqr # Lower Range\n\n#subset(data_pos, data_pos$wwwhr >= (Q[1] - 1.5*iqr) & data_pos$wwwhr <= (Q[2]+1.5*iqr))\n\n# I tried this method above and it cut almost 1000 observations. Any thoughts to why this happened? I'm confused...\n\nstats <- data_pos %>%\n  summarize(mean_wwwhr = mean(wwwhr, na.rm = TRUE),\n            sd_wwwhr = sd(wwwhr, na.rm = TRUE))\n\ndata_pos_filtered <- data_pos %>%\n  filter(wwwhr >= (stats$mean_wwwhr - 3 * stats$sd_wwwhr) & \n         wwwhr <= (stats$mean_wwwhr + 3 * stats$sd_wwwhr))\n\n\n\ncheck_outliers(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n3 outliers detected: cases 72, 156, 363.\n- Based on the following method and threshold: cook (0.9).\n- For variable: (Whole model).\n```\n\n\n:::\n:::\n\n\n\n\n\n## Refit the model after excluding outliers\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  new_model <- glm(wwwhr ~ wordsum + age + sex + reliten_recode + polviews + wrkhome,                  data = data_pos_filtered, \n                 family = poisson(link = \"log\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_parameters(new_model) %>%\n  print_html()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ogtpyujtpk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ogtpyujtpk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ogtpyujtpk thead, #ogtpyujtpk tbody, #ogtpyujtpk tfoot, #ogtpyujtpk tr, #ogtpyujtpk td, #ogtpyujtpk th {\n  border-style: none;\n}\n\n#ogtpyujtpk p {\n  margin: 0;\n  padding: 0;\n}\n\n#ogtpyujtpk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ogtpyujtpk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ogtpyujtpk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ogtpyujtpk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ogtpyujtpk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ogtpyujtpk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ogtpyujtpk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ogtpyujtpk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ogtpyujtpk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ogtpyujtpk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ogtpyujtpk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ogtpyujtpk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ogtpyujtpk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ogtpyujtpk .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ogtpyujtpk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ogtpyujtpk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ogtpyujtpk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ogtpyujtpk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ogtpyujtpk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ogtpyujtpk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ogtpyujtpk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ogtpyujtpk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ogtpyujtpk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ogtpyujtpk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ogtpyujtpk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ogtpyujtpk .gt_left {\n  text-align: left;\n}\n\n#ogtpyujtpk .gt_center {\n  text-align: center;\n}\n\n#ogtpyujtpk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ogtpyujtpk .gt_font_normal {\n  font-weight: normal;\n}\n\n#ogtpyujtpk .gt_font_bold {\n  font-weight: bold;\n}\n\n#ogtpyujtpk .gt_font_italic {\n  font-style: italic;\n}\n\n#ogtpyujtpk .gt_super {\n  font-size: 65%;\n}\n\n#ogtpyujtpk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ogtpyujtpk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ogtpyujtpk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ogtpyujtpk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ogtpyujtpk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ogtpyujtpk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ogtpyujtpk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#ogtpyujtpk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#ogtpyujtpk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SE\">SE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a95%-CI\">95% CI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"z\">z</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">2.10</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.08</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(1.95, 2.26)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">26.91</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">wordsum</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.09</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">8.31e-03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.08, 0.11)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">11.40</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">age</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.01</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">1.14e-03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.01, -9.04e-03)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-9.89</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">sex (Male)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.14</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.19, -0.08)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-4.85</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (linear)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.35</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.29, 0.41)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">11.35</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (quadratic)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.13</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.20, -0.06)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-3.53</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (cubic)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.05, 0.12)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">0.80</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.425 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">polviews</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.02</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.01</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.04, -8.11e-05)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-1.97</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.049 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">wrkhome</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">8.33e-03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.02, 0.06)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">4.79</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"6\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n### Check for Overdispersion\n\nHint: performance package has the function you're looking for\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_model(new_model,plot = T)\n```\n\n::: {.cell-output-display}\n![](poisson_lab_questions-1_files/figure-html/unnamed-chunk-11-1.png){width=1152}\n:::\n:::\n\n\n\n\n\nWhat do you notice? And what's a good next step forward? Can there be another model class that can fit the data? If so, fit this model to the data.\n\nI notice that we no longer have an outlier problem, but we do have an overdispersion problem. The next step would proably use a negative binomial regression model.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncheck_overdispersion(new_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Overdispersion test\n\n       dispersion ratio =   10.644\n  Pearson's Chi-Squared = 6237.607\n                p-value =  < 0.001\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n  binom_model <- glm.nb(wwwhr ~ wordsum + age + sex + reliten_recode + polviews + wrkhome, data = data_pos_filtered)\n\nsummary(binom_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm.nb(formula = wwwhr ~ wordsum + age + sex + reliten_recode + \n    polviews + wrkhome, data = data_pos_filtered, init.theta = 1.040080703, \n    link = log)\n\nCoefficients:\n                  Estimate Std. Error z value Pr(>|z|)    \n(Intercept)       2.116929   0.238400   8.880  < 2e-16 ***\nwordsum           0.100891   0.025398   3.972 7.11e-05 ***\nage              -0.012406   0.003439  -3.608 0.000309 ***\nsexMale          -0.105146   0.087533  -1.201 0.229667    \nreliten_recode.L  0.343975   0.095018   3.620 0.000294 ***\nreliten_recode.Q -0.106312   0.113643  -0.935 0.349533    \nreliten_recode.C  0.037056   0.134226   0.276 0.782494    \npolviews         -0.023980   0.032425  -0.740 0.459566    \nwrkhome           0.035173   0.026443   1.330 0.183483    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(1.0401) family taken to be 1)\n\n    Null deviance: 720.55  on 594  degrees of freedom\nResidual deviance: 661.65  on 586  degrees of freedom\n  (440 observations deleted due to missingness)\nAIC: 3808.7\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  1.0401 \n          Std. Err.:  0.0664 \n\n 2 x log-likelihood:  -3788.6810 \n```\n\n\n:::\n\n```{.r .cell-code}\nmodel_parameters(binom_model) %>%\n  print_html()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"kihcbvhtgu\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kihcbvhtgu table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kihcbvhtgu thead, #kihcbvhtgu tbody, #kihcbvhtgu tfoot, #kihcbvhtgu tr, #kihcbvhtgu td, #kihcbvhtgu th {\n  border-style: none;\n}\n\n#kihcbvhtgu p {\n  margin: 0;\n  padding: 0;\n}\n\n#kihcbvhtgu .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kihcbvhtgu .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kihcbvhtgu .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kihcbvhtgu .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kihcbvhtgu .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kihcbvhtgu .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kihcbvhtgu .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kihcbvhtgu .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kihcbvhtgu .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kihcbvhtgu .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kihcbvhtgu .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kihcbvhtgu .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kihcbvhtgu .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kihcbvhtgu .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kihcbvhtgu .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kihcbvhtgu .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kihcbvhtgu .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kihcbvhtgu .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kihcbvhtgu .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kihcbvhtgu .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kihcbvhtgu .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kihcbvhtgu .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kihcbvhtgu .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kihcbvhtgu .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kihcbvhtgu .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kihcbvhtgu .gt_left {\n  text-align: left;\n}\n\n#kihcbvhtgu .gt_center {\n  text-align: center;\n}\n\n#kihcbvhtgu .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kihcbvhtgu .gt_font_normal {\n  font-weight: normal;\n}\n\n#kihcbvhtgu .gt_font_bold {\n  font-weight: bold;\n}\n\n#kihcbvhtgu .gt_font_italic {\n  font-style: italic;\n}\n\n#kihcbvhtgu .gt_super {\n  font-size: 65%;\n}\n\n#kihcbvhtgu .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kihcbvhtgu .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kihcbvhtgu .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kihcbvhtgu .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kihcbvhtgu .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kihcbvhtgu .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kihcbvhtgu .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#kihcbvhtgu .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#kihcbvhtgu div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SE\">SE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a95%-CI\">95% CI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"z\">z</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">2.12</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.24</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(1.65, 2.59)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">8.88</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">wordsum</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.05, 0.15)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">3.97</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">age</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.01</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">3.44e-03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.02, -5.46e-03)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-3.61</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">sex (Male)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.11</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.09</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.28, 0.07)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-1.20</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.230 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (linear)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.34</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(0.16, 0.53)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">3.62</td>\n<td headers=\"p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (quadratic)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.11</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.11</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.33, 0.11)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-0.94</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.350 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">reliten recode (cubic)</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.13</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.24, 0.29)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">0.28</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.782 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">polviews</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">-0.02</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.09, 0.04)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">-0.74</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.460 </td></tr>\n    <tr><td headers=\"Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">wrkhome</td>\n<td headers=\"Coefficient\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"SE\" class=\"gt_row gt_center\">0.03</td>\n<td headers=\"95% CI\" class=\"gt_row gt_center\">(-0.02, 0.09)</td>\n<td headers=\"z\" class=\"gt_row gt_center\">1.33</td>\n<td headers=\"p\" class=\"gt_row gt_center\">0.183 </td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"6\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n\n\n## Which one is better- your earlier model, or later model?\n\nThe negative binomial model (so the later model) has a much lower AIC, so we can conclude the model fits the data better than the poisson\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntest_likelihoodratio(new_model, binom_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Likelihood-Ratio-Test (LRT) for Model Comparison (ML-estimator)\n\nName        |  Model | df | df_diff |    Chi2 |      p\n------------------------------------------------------\nnew_model   |    glm |  9 |         |         |       \nbinom_model | negbin | 10 |       1 | 3309.46 | < .001\n```\n\n\n:::\n\n```{.r .cell-code}\nAIC(new_model, binom_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            df      AIC\nnew_model    9 7116.145\nbinom_model 10 3808.681\n```\n\n\n:::\n:::\n\n\n\n\n\n## What is zero inflation? Is there zero-inflation in your chosen model?\n\nWhen there are too many zeros in your data, that can bias your result. There is indeed zero inflation in my chosen model.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperformance::check_zeroinflation(binom_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# Check for zero-inflation\n\n   Observed zeros: 40\n  Predicted zeros: 63\n            Ratio: 1.57\n```\n\n\n:::\n:::\n\n\n\n\n\n::: panel-tabset\n## Log Lambda\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlambda_poisson <- predict(new_model, type = \"response\")\nlambda_negbinom <- predict(binom_model, type = \"response\")\n\n# Log transform the lambda values\nlog_lambda_poisson <- log(lambda_poisson)\nlog_lambda_negbinom <- log(lambda_negbinom)\n\n# Output the log lambda values for a subset of the data\nhead(data.frame(log_lambda_poisson, log_lambda_negbinom))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   log_lambda_poisson log_lambda_negbinom\n1            2.075745            2.079081\n2            2.858883            2.913070\n4            2.192097            2.220856\n8            2.263431            2.252398\n9            2.064265            2.030755\n12           2.549028            2.592963\n```\n\n\n:::\n:::\n\n\n\n\n\n## Mean Count\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npredicted_counts_poisson <- predict(new_model, type = \"response\")\npredicted_counts_negbinom <- predict(binom_model, type = \"response\")\n\n# Calculate the mean of predicted counts for each model\nmean_count_poisson <- mean(predicted_counts_poisson, na.rm = TRUE)\nmean_count_negbinom <- mean(predicted_counts_negbinom, na.rm = TRUE)\n\n# Output the mean counts\nmean_count_poisson\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8.821849\n```\n\n\n:::\n\n```{.r .cell-code}\nmean_count_negbinom\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 8.836638\n```\n\n\n:::\n:::\n\n\n\n\n:::\n\n## Report your conclusions\n\nIt seems like the negative binomial model outputs slightly higher mean counts and log lambdas than the poisson distribution. It seems like we should favor the negative binomial outputs over the poisson.\n\nWe initally fitted a poisson model to predict the number of hours per week that a person spends on the Internet (\"WWWHR\") using their vocabulary (\"WORDSUM\"), age (\"AGE\"), sex (\"SEX\"), religiosity (\"RELITEN\"), political orientation (\"POLVIEWS\"), and how often they work from home (\"WRKHOME\") as fixed effects. We then fit a negative binomial model instead because there were too many outliers, in this model, only the effects of wordsum, age, and religiosity (linear) were significant but not those of sex, polviews, or working from home.\n",
    "supporting": [
      "poisson_lab_questions-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}